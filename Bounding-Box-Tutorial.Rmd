---
author: Jim Junker
date: '`r format(Sys.Date())`'
title: Bounding Box Tutorial
subtitle: Workflow to annotate, train, and predict bounding boxes for AutoTaxonomizer
output: html_document
---

```{r setup, include = FALSE, echo = FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
library(here)
i_am('Bounding-Box-Tutorial.Rmd')
library(reticulate)

```

```{r initiate environments}
# setup the virtual environment for python
if (!dir.exists(here("virtualenv/"))) {
  reticulate::conda_create(here("virtualenv/"))
}
# the .Rprofile should automatically use this python version
reticulate::use_condaenv(here('virtualenv/'))
# let's install the required python modules
if(!all(reticulate::py_module_available('sklearn'), 
        reticulate::py_module_available('PIL'),
        reticulate::py_module_available('matplotlib'),
        reticulate::py_module_available('json'))
   ){
reticulate::conda_install(
  packages = c('scikit-learn', 'Pillow','matplotlib','json'),
  envname = here('virtualenv/')
)}

if(!reticulate::py_module_available('tensorflow')){
reticulate::py_install(
  packages = c('tensorflow'),
  envname = here('virtualenv/'),
  pip = TRUE#,
  # pip_ignore_installed =TRUE
)}
# set to use the local python environment
# sklearn <- reticulate::import('sklearn', convert = FALSE)
# tf <- reticulate::import('tensorflow', convert = FALSE)

reticulate::source_python(here("code/train_chatGPT_YOLO.py"))
reticulate::source_python(here("code/evaluate_chatGPT_YOLO.py"))

```

# Purpose

This document outlines the steps to setup the workflow for image detection of aquatic macroinvertebrates for the 'AutoTaxonomizer' project. It includes steps to download and configure tools to help annotate images, export bounding box information, and train and validate a bounding box regression model to automate the bounding box process.

## Setup

First, we need to ensure we have the necessary programs are install on your device. To accomplish the tasks, the following programs are required:

- Python [windows](https://www.python.org/downloads/windows/),[macOS](https://www.python.org/downloads/macos/)

- Tensorflow [windows](https://www.tensorflow.org/install/pip#windows-wsl2), [macOS](https://www.tensorflow.org/install/pip#macos)

optional programs:

- 

## Image annotation

The process of image annotation is a necessary, if laborious, process for image detection. To streamline the process we will use the open data annotation platform, [CVAT](https://www.cvat.ai/). We will run the platform through a shared organization, contact Jim (james.junker@unt.edu) to get access to the organization. The organization is organized based on projects and specific tasks within projects. 

- get some screenshots of workflow

- CVAT 

- saving procedures and output directions for directory

- 

## Bounding Box Regression

This outline is loosely based upon this guide [here](https://pyimagesearch.com/2020/10/05/object-detection-bounding-box-regression-with-keras-tensorflow-and-deep-learning/). With a video tutorial [here](https://www.google.com/search?client=firefox-b-1-e&q=bounding+box+regression+Keras+Tensorflow+tutorial+with+code#fpstate=ive&vld=cid:eaa207bd,vid:QcA7zjBpbVg,st:0).

<center>Be sure you have installed Python and Tensorflow to perform the following analyses.</center>



<!-- #https://pyimagesearch.com/2019/06/03/fine-tuning-with-keras-and-deep-learning/ -->


&nbsp;

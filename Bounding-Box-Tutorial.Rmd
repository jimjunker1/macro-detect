---
author: Jim Junker
date: '`r format(Sys.Date())`'
title: Bounding Box Tutorial
subtitle: Workflow to annotate, train, and predict bounding boxes for AutoTaxonomizer
output: html_document
---

```{r setup, include = FALSE, echo = FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
library(here)
i_am('Bounding-Box-Tutorial.Rmd')

```

# Purpose

This document outlines the steps to setup the workflow for image detection of aquatic macroinvertebrates for the 'AutoTaxonomizer' project. It includes steps to download and configure tools to help annotate images, export bounding box information, and train and validate a bounding box regression model to automate the bounding box process.

## Setup

The current project is configured to minimize individual set up time. To do this, it manages directories using the `here`packages and the package library using the `renv`package for organizing specific packages and versions. The `renv` library is loaded when the project is opened. However, there are a few steps that need to be taken to initialize the project on a new computer.

First, we need to ensure we have the necessary programs are installed on your device. The following programs are required:

- Python [windows](https://www.python.org/downloads/windows/),[macOS](https://www.python.org/downloads/macos/)

This program can be installed from the [`reticulate`](https://rstudio.github.io/reticulate/index.html) package's `install_python()` function. `reticulate` should be loaded by `renv` and then Python can be installed with:  

```{r install python, echo = TRUE, eval = FALSE}

reticulate::install_python()

```

Second, you can install the conda environment manager with:

```{r install conda, echo = TRUE, eval = FALSE}
reticulate::install_miniconda()
```

This allows us to manage environments and package dependencies necessary for performing the machine learning procedures below.

Lastly, we can initiate other project level setup that will create a virtual environment to manage python modules. Sourcing the R script will create a new folder and install the required modules:

```{r initiate environments, echo=TRUE, eval=FALSE}
source(here("code/initiate-envs.R"))
```

## Image annotation

The process of image annotation is a necessary, if laborious, process for image detection. To streamline the process we will use the open data annotation platform, [CVAT](https://www.cvat.ai/). We will run the platform through a shared organization, contact Jim (james.junker@unt.edu) to get access to the organization. The organization is organized based on projects and specific tasks within projects. 

- get some screenshots of workflow

- CVAT 

- saving procedures and output directions for directory

- 

## Bounding Box Regression

This outline is loosely based upon this guide [here](https://pyimagesearch.com/2020/10/05/object-detection-bounding-box-regression-with-keras-tensorflow-and-deep-learning/). With a video tutorial [here](https://www.google.com/search?client=firefox-b-1-e&q=bounding+box+regression+Keras+Tensorflow+tutorial+with+code#fpstate=ive&vld=cid:eaa207bd,vid:QcA7zjBpbVg,st:0).

<center>Be sure you have installed Python and Tensorflow to perform the following analyses.</center>

Load the required definitions for training the bounding box regression on 

```{r initiate python script, echo = TRUE, eval = FALSE}
reticulate::source_python(here("code/train_chatGPT_YOLO.py"))
reticulate::source_python(here("code/evaluate_chatGPT_YOLO.py"))
```

The procedure to perform the bounding box regression can be

<!-- #https://pyimagesearch.com/2019/06/03/fine-tuning-with-keras-and-deep-learning/ -->


&nbsp;
